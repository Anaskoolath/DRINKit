{% load static%}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Details</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .alert {
        padding: 20px;
        background-color: #4CAF50; /* Green */
        color: white;
        margin-bottom: 15px;
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        border-radius: 5px;
        opacity: 1;
        transition: opacity 0.6s;
    }

    .alert.success {background-color: #4CAF50;}
    .alert.info {background-color: #2196F3;}
    .alert.warning {background-color: #ff9800;}
    .alert.error {background-color: #f44336;}

    .closebtn {
        margin-left: 15px;
        color: white;
        font-weight: bold;
        float: right;
        font-size: 22px;
        line-height: 20px;
        cursor: pointer;
        transition: 0.3s;
    }

    .closebtn:hover {
        color: black;
    }
    </style>
</head>
<body class="bg-gray-100 animate-fade-in-up flex flex-col min-h-screen">
    {% include 'demo/navbar.html' %}
    <div class="p-4 md:p-6 flex-grow">


    {% if messages %}
<div id="message-container">
{% for message in messages %}
    <div class="alert {{ message.tags }}">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span> 
        {{ message }}
    </div>
{% endfor %}
</div>

<script>
    // Automatically close the alert after 5 seconds
    setTimeout(function() {
        let messageContainer = document.getElementById('message-container');
        if (messageContainer) {
            let alerts = messageContainer.getElementsByClassName('alert');
            for (let i = 0; i < alerts.length; i++) {
                alerts[i].style.opacity = '0';
                // Wait for the fade-out transition to finish before hiding the element
                setTimeout(function(){ alerts[i].style.display = 'none'; }, 600); 
            }
        }
    }, 5000); // 5000ms = 5 seconds
</script>
{% endif %}

    <div class="max-w-4xl mx-auto">
        <div class="bg-white p-6 rounded-xl shadow-md mb-6">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                <div>
                    <h1 class="text-2xl font-bold">{{ cst.name }}</h1>
                    <p class="text-gray-600">Email: {{ cst.email }}</p>
                    <p class="text-gray-600">Phone: {{ cst.phone }}</p>
                </div>
                <div class="flex items-center gap-2">
                    <a href="{% url 'update_customer' cst.id %}?next={{ request.path }}" class="bg-yellow-500 text-white px-4 py-2 rounded-md hover:bg-yellow-600 text-sm font-semibold">Modify Customer</a>
                    <a href="{% url 'create_order_bulk' cst.id %}?next={{ request.path }}" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 text-sm font-semibold">Place Order</a>
                    <a href="{% url 'home' %}" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 text-sm font-semibold">Back to Home</a>
                </div>
            </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Orders for {{ cst.name }}</h2>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead>
                        <tr class="border-b bg-gray-50">
                            <th class="py-3 px-4">Product</th>
                            <th class="py-3 px-4">Date Ordered</th>
                            <th class="py-3 px-4">Status</th>
                            <th class="py-3 px-4 text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in orders %}
                        <tr class="border-b hover:bg-gray-50">
                            <td class="py-3 px-4">{{ order.product.name }}</td>
                            <td class="py-3 px-4">{{ order.date_created|date:"M d, Y" }}</td>
                            <td class="py-3 px-4">{{ order.status }}</td>
                            <td class="py-3 px-4 text-center space-x-2">
                                <a href="{% url 'update_order' order.id %}?next={{ request.path }}" class="text-blue-500 hover:underline">Update</a>
                                <a href="{% url 'delete_order' order.id %}?next={{ request.path }}" class="text-red-500 hover:underline">Remove</a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" class="py-6 text-center text-gray-500">This customer has no orders.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    </div>
    {% include 'demo/footer.html' %}
</body>
</html>